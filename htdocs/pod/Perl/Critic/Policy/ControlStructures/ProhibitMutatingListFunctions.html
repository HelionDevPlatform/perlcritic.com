<HTML>
<HEAD>
<TITLE>Perl::Critic::Policy::ControlStructures::ProhibitMutatingListFunctions</TITLE>
<LINK href="/styles/pod.css" type="text/css" rel="stylesheet"></HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<UL>
<LI><A HREF="#NAME">NAME

</A><LI><A HREF="#AFFILIATION">AFFILIATION

</A><LI><A HREF="#DESCRIPTION">DESCRIPTION

</A><LI><A HREF="#CONFIGURATION">CONFIGURATION

</A><LI><A HREF="#LIMITATIONS">LIMITATIONS

</A><LI><A HREF="#SEE%20ALSO">SEE ALSO

</A><LI><A HREF="#AUTHOR">AUTHOR

</A><LI><A HREF="#COPYRIGHT">COPYRIGHT

</A></UL>
<HR>
<H1><A NAME="NAME">NAME

</A></H1>

<P>Perl::Critic::Policy::ControlStructures::ProhibitMutatingListFunctions - Don't modify <CODE>$_</CODE> in list functions.


</P><H1><A NAME="AFFILIATION">AFFILIATION

</A></H1>

<P>This Policy is part of the core <A HREF="../../../../Perl/Critic.html">Perl::Critic</A>
distribution.


</P><H1><A NAME="DESCRIPTION">DESCRIPTION

</A></H1>

<P><CODE>map</CODE>, <CODE>grep</CODE> and other list operators are intended to transform
arrays into other arrays by applying code to the array elements one by
one.  For speed, the elements are referenced via a <CODE>$_</CODE> alias rather
than copying them.  As a consequence, if the code block of the <CODE>map</CODE>
or <CODE>grep</CODE> modify <CODE>$_</CODE> in any way, then it is actually modifying the
source array.  This IS technically allowed, but those side effects can
be quite surprising, especially when the array being passed is <CODE>@_</CODE>
or perhaps <CODE>values(%ENV)</CODE>!  Instead authors should restrict in-place
array modification to <CODE>for(@array) { ... }</CODE> constructs instead, or
use <CODE>List::MoreUtils::apply()</CODE>.

</P><H1><A NAME="CONFIGURATION">CONFIGURATION

</A></H1>

<P>By default, this policy applies to the following list functions:

</P>
<PRE>    map grep
    List::Util qw(first)
    List::MoreUtils qw(any all none notall true false firstidx
                       first_index lastidx last_index insert_after
                       insert_after_string)</PRE>

<P>This list can be overridden the <I>.perlcriticrc</I> file like this:

</P>
<PRE>    [ControlStructures::ProhibitMutatingListFunctions]
    list_funcs = map grep List::Util::first</PRE>

<P>Or, one can just append to the list like so:

</P>
<PRE>    [ControlStructures::ProhibitMutatingListFunctions]
    add_list_funcs = Foo::Bar::listmunge</PRE>
<H1><A NAME="LIMITATIONS">LIMITATIONS

</A></H1>

<P>This policy deliberately does not apply to <CODE>for (@array) { ... }</CODE> or
<CODE>List::MoreUtils::apply()</CODE>.

</P>
<P>Currently, the policy only detects explicit external module usage like
this:

</P>
<PRE>    my @out = List::MoreUtils::any {s/^foo//} @in;</PRE>

<P>and not like this:

</P>
<PRE>    use List::MoreUtils qw(any);
    my @out = any {s/^foo//} @in;</PRE>

<P>This policy looks only for modifications of <CODE>$_</CODE>.  Other naughtiness
could include modifying <CODE>$a</CODE> and <CODE>$b</CODE> in <CODE>sort</CODE> and the like.
That's beyond the scope of this policy.


</P><H1><A NAME="SEE%20ALSO">SEE ALSO

</A></H1>

<P>There is discussion of this policy at
<A HREF="http://perlmonks.org/index.pl?node_id=743445">http://perlmonks.org/index.pl?node_id=743445</A>.


</P><H1><A NAME="AUTHOR">AUTHOR

</A></H1>

<P>Chris Dolan &lt;cdolan@cpan.org&gt;

</P>
<P>Michael Wolf &lt;MichaelRWolf@att.net&gt;


</P><H1><A NAME="COPYRIGHT">COPYRIGHT

</A></H1>

<P>Copyright (c) 2006-2010 Chris Dolan.

</P>
<P>This program is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

</P>
</BODY>
</HTML>
