<HTML>
<HEAD>
<TITLE>Perl::Critic::Policy::ValuesAndExpressions::ProhibitCommaSeparatedStatements</TITLE>
<BASE href="http://perlcritic.com/pod/"><LINK href="/styles/pod.css" type="text/css" rel="stylesheet"></HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<UL>
<LI><A HREF="#NAME">NAME

</A><LI><A HREF="#AFFILIATION">AFFILIATION

</A><LI><A HREF="#DESCRIPTION">DESCRIPTION

</A><LI><A HREF="#CONFIGURATION">CONFIGURATION

</A><LI><A HREF="#BUGS">BUGS

</A><LI><A HREF="#AUTHOR">AUTHOR

</A><LI><A HREF="#COPYRIGHT">COPYRIGHT

</A></UL>
<HR>
<H1><A NAME="NAME">NAME

</A></H1>

<P>Perl::Critic::Policy::ValuesAndExpressions::ProhibitCommaSeparatedStatements - Don't use the comma operator as a statement separator.

</P><H1><A NAME="AFFILIATION">AFFILIATION

</A></H1>

<P>This Policy is part of the core <A HREF="../../../../Perl/Critic.html">Perl::Critic</A>
distribution.


</P><H1><A NAME="DESCRIPTION">DESCRIPTION

</A></H1>

<P>Perl's comma statement separator has really low precedence, which
leads to code that looks like it's using the comma list element
separator not actually doing so.  Conway suggests that the statement
separator not be used in order to prevent this situation.

</P>
<P>The confusion that the statement separator causes is primarily due to
the assignment operators having higher precedence.

</P>
<P>For example, trying to combine two arrays into another like this won't
work:

</P>
<PRE>    @x = @y, @z;</PRE>

<P>because it is equivalent to

</P>
<PRE>    @x = @y;
    @z;</PRE>

<P>Conversely, there are the built-in functions, like <CODE>print</CODE>, that
normally force the rest of the statement into list context, but don't
when called like a subroutine.

</P>
<P>This is not likely to produce what is intended:

</P>
<PRE>    print join q{, }, 2, 3, 5, 7, &quot;: the single-digit primes.\n&quot;;</PRE>

<P>The obvious fix is to add parentheses.  Placing them like

</P>
<PRE>    print join( q{, }, 2, 3, 5, 7 ), &quot;: the single-digit primes.\n&quot;;</PRE>

<P>will work, but

</P>
<PRE>    print ( join q{, }, 2, 3, 5, 7 ), &quot;: the single-digit primes.\n&quot;;</PRE>

<P>will not, because it is equivalent to

</P>
<PRE>    print( join q{, }, 2, 3, 5, 7 );
    &quot;: the single-digit primes.\n&quot;;
</PRE>
<H1><A NAME="CONFIGURATION">CONFIGURATION

</A></H1>

<P>This policy can be configured to allow the last statement in a <CODE>map</CODE>
or <CODE>grep</CODE> block to be comma separated.  This is done via the
<CODE>allow_last_statement_to_be_comma_separated_in_map_and_grep</CODE> option
like so:

</P>
<PRE>    [ValuesAndExpressions::ProhibitCommaSeparatedStatements]
    allow_last_statement_to_be_comma_separated_in_map_and_grep = 1</PRE>

<P>With this option off (the default), the following code violates this
policy.

</P>
<PRE>    %hash = map {$_, 1} @list;</PRE>

<P>With this option on, this statement is allowed.  Even if this option
is off, using a fat comma <CODE>=&gt;</CODE> works, but that forces
stringification on the first value, which may not be what you want.


</P><H1><A NAME="BUGS">BUGS

</A></H1>

<P>Needs to check for <CODE>scalar( something, something )</CODE>.


</P><H1><A NAME="AUTHOR">AUTHOR

</A></H1>

<P>Elliot Shank <CODE>&lt;perl@galumph.com&gt;</CODE>


</P><H1><A NAME="COPYRIGHT">COPYRIGHT

</A></H1>

<P>Copyright (c) 2007-2011 Elliot Shank.

</P>
<P>This program is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.  The full text of this license
can be found in the LICENSE file included with this module.

</P>
</BODY>
</HTML>
