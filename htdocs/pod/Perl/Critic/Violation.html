<HTML>
<HEAD>
<TITLE>Perl::Critic::Violation</TITLE>
<BASE href="http://perlcritic.com/pod/"><LINK href="/styles/pod.css" type="text/css" rel="stylesheet"></HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000">
<UL>
<LI><A HREF="#NAME">NAME

</A><LI><A HREF="#SYNOPSIS">SYNOPSIS

</A><LI><A HREF="#DESCRIPTION">DESCRIPTION

</A><LI><A HREF="#INTERFACE%20SUPPORT">INTERFACE SUPPORT

</A><LI><A HREF="#CONSTRUCTOR">CONSTRUCTOR

</A><LI><A HREF="#METHODS">METHODS

</A><LI><A HREF="#OVERLOADS">OVERLOADS

</A><LI><A HREF="#AUTHOR">AUTHOR

</A><LI><A HREF="#COPYRIGHT">COPYRIGHT

</A></UL>
<HR>
<H1><A NAME="NAME">NAME

</A></H1>

<P>Perl::Critic::Violation - A violation of a Policy found in some source code.


</P><H1><A NAME="SYNOPSIS">SYNOPSIS

</A></H1>

<PRE>  use PPI;
  use Perl::Critic::Violation;

  my $elem = $doc-&gt;child(0);      # $doc is a PPI::Document object
  my $desc = 'Offending code';    # Describe the violation
  my $expl = [1,45,67];           # Page numbers from PBP
  my $sev  = 5;                   # Severity level of this violation

  my $vio  = Perl::Critic::Violation-&gt;new($desc, $expl, $node, $sev);
</PRE>
<H1><A NAME="DESCRIPTION">DESCRIPTION

</A></H1>

<P>Perl::Critic::Violation is the generic representation of an individual
Policy violation.  Its primary purpose is to provide an abstraction
layer so that clients of <A HREF="../../Perl/Critic.html">Perl::Critic</A> don't have to
know anything about <A HREF="../../PPI.html">PPI</A>.  The <CODE>violations</CODE> method of all
<A HREF="../../Perl/Critic/Policy.html">Perl::Critic::Policy</A> subclasses must return a
list of these Perl::Critic::Violation objects.


</P><H1><A NAME="INTERFACE%20SUPPORT">INTERFACE SUPPORT

</A></H1>

<P>This is considered to be a public class.  Any changes to its interface
will go through a deprecation cycle.


</P><H1><A NAME="CONSTRUCTOR">CONSTRUCTOR

</A></H1>
<DL><DT><A NAME="new(%20%24description%2c%20%24explanation%2c%20%24element%2c%20%24severity%20)"><CODE>new( $description, $explanation, $element, $severity )</CODE>

</A></DT>
<DD>
Returns a reference to a new <CODE>Perl::Critic::Violation</CODE> object. The
arguments are a description of the violation (as string), an
explanation for the policy (as string) or a series of page numbers in
PBP (as an ARRAY ref), a reference to the <A HREF="../../PPI.html">PPI</A> element that
caused the violation, and the severity of the violation (as an
integer).


</DD>
</DL>
<H1><A NAME="METHODS">METHODS

</A></H1>
<DL><DT><A NAME="description()"><CODE>description()</CODE>

</A></DT>
<DD>
Returns a brief description of the specific violation.  In other
words, this value may change on a per violation basis.


</DD>
<DT><A NAME="explanation()"><CODE>explanation()</CODE>

</A></DT>
<DD>
Returns an explanation of the policy as a string or as reference to an
array of page numbers in PBP.  This value will generally not change
based upon the specific code violating the policy.


</DD>
<DT><A NAME="location()"><CODE>location()</CODE>

</A></DT>
<DD>

<P>Don't use this method.  Use the <CODE>line_number()</CODE>,
<CODE>logical_line_number()</CODE>, <CODE>column_number()</CODE>,
<CODE>visual_column_number()</CODE>, and <CODE>logical_filename()</CODE> methods instead.

</P>
<P>Returns a five-element array reference containing the line and real &amp;
virtual column and logical numbers and logical file name where this
Violation occurred, as in <A HREF="../../PPI/Element.html">PPI::Element</A>.


</P></DD>
<DT><A NAME="line_number()"><CODE>line_number()</CODE>

</A></DT>
<DD>
Returns the physical line number that the violation was found on.


</DD>
<DT><A NAME="logical_line_number()"><CODE>logical_line_number()</CODE>

</A></DT>
<DD>
Returns the logical line number that the violation was found on.  This
can differ from the physical line number when there were <CODE>#line</CODE>
directives in the code.


</DD>
<DT><A NAME="column_number()"><CODE>column_number()</CODE>

</A></DT>
<DD>
Returns the physical column that the violation was found at.  This
means that hard tab characters count as a single character.


</DD>
<DT><A NAME="visual_column_number()"><CODE>visual_column_number()</CODE>

</A></DT>
<DD>
Returns the column that the violation was found at, as it would appear
if hard tab characters were expanded, based upon the value of
<A HREF="../../PPI/Document.html#tab_width%20%5b%20%24width%20%5d">PPI::Document/&quot;tab_width [ $width ]&quot;</A>.


</DD>
<DT><A NAME="filename()"><CODE>filename()</CODE>

</A></DT>
<DD>
Returns the path to the file where this Violation occurred.  In some
cases, the path may be undefined because the source code was not read
directly from a file.


</DD>
<DT><A NAME="logical_filename()"><CODE>logical_filename()</CODE>

</A></DT>
<DD>
Returns the logical path to the file where the Violation occurred.
This can differ from <CODE>filename()</CODE> when there was a <CODE>#line</CODE> directive
in the code.


</DD>
<DT><A NAME="severity()"><CODE>severity()</CODE>

</A></DT>
<DD>
Returns the severity of this Violation as an integer ranging from 1 to
5, where 5 is the &quot;most&quot; severe.


</DD>
<DT><A NAME="sort_by_severity(%20%40violation_objects%20)"><CODE>sort_by_severity( @violation_objects )</CODE>

</A></DT>
<DD>

<P>If you need to sort Violations by severity, use this handy routine:

</P>
<PRE>    @sorted = Perl::Critic::Violation::sort_by_severity(@violations);
</PRE>
</DD>
<DT><A NAME="sort_by_location(%20%40violation_objects%20)"><CODE>sort_by_location( @violation_objects )</CODE>

</A></DT>
<DD>

<P>If you need to sort Violations by location, use this handy routine:

</P>
<PRE>    @sorted = Perl::Critic::Violation::sort_by_location(@violations);
</PRE>
</DD>
<DT><A NAME="diagnostics()"><CODE>diagnostics()</CODE>

</A></DT>
<DD>
Returns a formatted string containing a full discussion of the
motivation for and details of the Policy module that created this
Violation.  This information is automatically extracted from the
<CODE>DESCRIPTION</CODE> section of the Policy module's POD.


</DD>
<DT><A NAME="policy()"><CODE>policy()</CODE>

</A></DT>
<DD>
Returns the name of the <A HREF="../../Perl/Critic/Policy.html">Perl::Critic::Policy</A>
that created this Violation.


</DD>
<DT><A NAME="source()"><CODE>source()</CODE>

</A></DT>
<DD>
Returns the string of source code that caused this exception.  If the
code spans multiple lines (e.g. multi-line statements, subroutines or
other blocks), then only the first line will be returned.


</DD>
<DT><A NAME="element_class()"><CODE>element_class()</CODE>

</A></DT>
<DD>
Returns the <A HREF="../../PPI/Element.html">PPI::Element</A> subclass of the code that caused this
exception.


</DD>
<DT><A NAME="set_format(%20%24format%20)"><CODE>set_format( $format )</CODE>

</A></DT>
<DD>
Class method.  Sets the format for all Violation objects when they are
evaluated in string context.  The default is <CODE>'%d at line %l, column
%c. %e'</CODE>.  See <A HREF="#OVERLOADS">&quot;OVERLOADS&quot;</A> for formatting options.


</DD>
<DT><A NAME="get_format()"><CODE>get_format()</CODE>

</A></DT>
<DD>
Class method. Returns the current format for all Violation objects
when they are evaluated in string context.


</DD>
<DT><A NAME="to_string()"><CODE>to_string()</CODE>

</A></DT>
<DD>
Returns a string representation of this violation.  The content of the
string depends on the current value of the <CODE>$format</CODE> package
variable.  See <A HREF="#OVERLOADS">&quot;OVERLOADS&quot;</A> for the details.


</DD>
</DL>
<H1><A NAME="OVERLOADS">OVERLOADS

</A></H1>

<P>Perl::Critic::Violation overloads the <CODE>&quot;&quot;</CODE> operator to produce neat
little messages when evaluated in string context.

</P>
<P>Formats are a combination of literal and escape characters similar to
the way <CODE>sprintf</CODE> works.  If you want to know the specific formatting
capabilities, look at <A HREF="../../String/Format.html">String::Format</A>. Valid escape
characters are:

</P>
<PRE>    Escape    Meaning
    -------   ----------------------------------------------------------------
    %c        Column number where the violation occurred
    %d        Full diagnostic discussion of the violation (DESCRIPTION in POD)
    %e        Explanation of violation or page numbers in PBP
    %F        Just the name of the logical file where the violation occurred.
    %f        Path to the logical file where the violation occurred.
    %G        Just the name of the physical file where the violation occurred.
    %g        Path to the physical file where the violation occurred.
    %l        Logical line number where the violation occurred
    %L        Physical line number where the violation occurred
    %m        Brief description of the violation
    %P        Full name of the Policy module that created the violation
    %p        Name of the Policy without the Perl::Critic::Policy:: prefix
    %r        The string of source code that caused the violation
    %C        The class of the PPI::Element that caused the violation
    %s        The severity level of the violation</PRE>

<P>Explanation of the <CODE>%F</CODE>, <CODE>%f</CODE>, <CODE>%G</CODE>, <CODE>%G</CODE>, <CODE>%l</CODE>, and <CODE>%L</CODE> formats:
Using <CODE>#line</CODE> directives, you can affect what perl thinks the current line
number and file name are; see <A HREF="../../perlsyn.html#Plain%20Old%20Comments%20(Not!)">perlsyn/Plain Old Comments (Not!)</A> for
the details.  Under normal circumstances, the values of <CODE>%F</CODE>, <CODE>%f</CODE>, and
<CODE>%l</CODE> will match the values of <CODE>%G</CODE>, <CODE>%g</CODE>, and <CODE>%L</CODE>, respectively.  In the
presence of a <CODE>#line</CODE> directive, the values of <CODE>%F</CODE>, <CODE>%f</CODE>, and <CODE>%l</CODE> will
change to take that directive into account.  The values of <CODE>%G</CODE>, <CODE>%g</CODE>, and
<CODE>%L</CODE> are unaffected by those directives.

</P>
<P>Here are some examples:

</P>
<PRE>    Perl::Critic::Violation::set_format(&quot;%m at line %l, column %c.\n&quot;);
    # looks like &quot;Mixed case variable name at line 6, column 23.&quot;

    Perl::Critic::Violation::set_format(&quot;%m near '%r'\n&quot;);
    # looks like &quot;Mixed case variable name near 'my $theGreatAnswer = 42;'&quot;

    Perl::Critic::Violation::set_format(&quot;%l:%c:%p\n&quot;);
    # looks like &quot;6:23:NamingConventions::Capitalization&quot;

    Perl::Critic::Violation::set_format(&quot;%m at line %l. %e. \n%d\n&quot;);
    # looks like &quot;Mixed case variable name at line 6.  See page 44 of PBP.
      Conway's recommended naming convention is to use lower-case words
      separated by underscores.  Well-recognized acronyms can be in ALL
      CAPS, but must be separated by underscores from other parts of the
      name.&quot;
</PRE>
<H1><A NAME="AUTHOR">AUTHOR

</A></H1>

<P>Jeffrey Ryan Thalhammer &lt;jeff@imaginative-software.com&gt;


</P><H1><A NAME="COPYRIGHT">COPYRIGHT

</A></H1>

<P>Copyright (c) 2005-2011 Imaginative Software Systems.  All rights reserved.

</P>
<P>This program is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.  The full text of this license
can be found in the LICENSE file included with this module.

</P>
</BODY>
</HTML>
